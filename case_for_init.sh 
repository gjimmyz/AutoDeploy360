#!/bin/bash
scripts_path="/root/scripts"
auto_deploy_path="${scripts_path}/AutoDeploy360/based_on_role_yaml/main_exe"
ssh_host="root@10.xxx.xxx.75"

time_clock_cron_check_script="time_clock_cron_check_main/time_clock_cron_check.txt"
gather_all_ip_script="gather_all_ip/gather_all_ip.txt"

init_for_centos7_script="init_for_centos7_US20/init.py"
init_deploy_cube_script="init_deploy_cube/init_deploy_cube.py"
check_all_script="check_all/check_role.py"
install_samba_script="install_samba/install_samba.py"
check_time_clock_script="check_time_clock/check_time_clock.py"

retry_message="try again"

function run_script() {
    cd $auto_deploy_path && python3 $1
}
function run_cron_manager() {
    cd $auto_deploy_path && python3 cron_manager.py $1
}

if [[ `id -u` -eq 0 ]]
then
    while true
    do
        echo -e "
        \033[31m 1|a|A 初始化+业务部署 \033[0m
        \033[32m 2|b|B 软件安装 \033[0m
        \033[33m 3|c|C 计划任务 \033[0m
        \033[34m 4|d|D 进入管理系统 \033[0m
        \033[35m 5|e|E 进入github commit \033[0m
        \033[36m 99|q|Q 退出 \033[0m
        "
        read -p "请选择主菜单选项: " main_menu_choice
        case $main_menu_choice in
            1|a|A)
                while true
                do
                    echo -e "
                    \033[31m 1|a|A 初始化 US20、Centos7 \033[0m
                    \033[32m 2|b|B 迷你 PC Intel NUC业务_US2004 8168 Nic Driver \033[0m
                    \033[33m 3|c|C 检查 US20、Centos7 或自定义主机 \033[0m
                    \033[34m 4|d|D 返回主菜单 \033[0m
                    \033[35m 99|q|Q 退出 \033[0m
                    "
                    read -p "请选择二级菜单选项: " submenu_choice
                    case $submenu_choice in
                        1|a|A)
                            run_script $init_for_centos7_script
                            ;;
                        2|b|B)
                            run_script $init_deploy_cube_script
                            ;;
                        3|c|C)
                            run_script $check_all_script
                            ;;
                        4|d|D)
                            break
                            ;;
                        99|q|Q)
                            exit 0
                            ;;
                        *)
                            echo $retry_message
                            ;;
                    esac
                done
                ;;
            2|b|B)
                while true
                do
                    echo -e "
                    \033[31m 1|a|A 单一软件安装 \033[0m
                    \033[32m 2|b|B 集群软件安装 \033[0m
                    \033[33m 3|c|C 返回主菜单 \033[0m
                    \033[34m 99|q|Q 退出 \033[0m
                    "
                    read -p "请选择子菜单选项: " submenu_choice
                    case $submenu_choice in
                        1|a|A)
                            while true
                            do
                                echo -e "
                                \033[31m 1|a|A Install Samba \033[0m
                                \033[32m 2|b|B xxxx \033[0m
                                \033[33m 3|c|C xxx \033[0m
                                \033[34m 4|d|D 返回主菜单 \033[0m
                                \033[35m 99|q|Q 退出 \033[0m
                                "
                                read -p "请选择子菜单选项: " three_menu_choice
                                case $three_menu_choice in
                                    1|a|A)
                                        run_script $install_samba_script
                                        ;;
                                    2|b|B)
                                        echo "Pending 2"
                                        ;;
                                    3|c|C)
                                        echo "Pending 3"
                                        ;;
                                    4|d|D)
                                        break
                                        ;;
                                    99|q|Q)
                                        exit 0
                                        ;;
                                    *)
                                        echo $retry_message
                                        ;;
                                esac
                            done
                            ;;
                        2|b|B)
                            echo "Pending 1"
                            ;;
                        3|c|C)
                            break
                            ;;
                        99|q|Q)
                            exit 0
                            ;;
                        *)
                            echo $retry_message
                            ;;
                    esac
                done
                ;;
            3|c|C)
                while true
                do
                    echo -e "
                    \033[31m 1|a|A 通过nmap扫描获取主机后，任务是检查时间 \033[0m
                    \033[32m 2|b|B 自定义主机配置，任务是检查时间 \033[0m
                    \033[33m 3|c|C 收集ip \033[0m
                    \033[34m 4|d|D 计划任务4 \033[0m
                    \033[35m 5|e|E 返回主菜单 \033[0m
                    \033[36m 99|q|Q 退出 \033[0m
                    "
                    read -p "请选择二级菜单选项: " submenu_choice
                    case $submenu_choice in
                        1|a|A)
                            run_script $check_time_clock_script
                            ;;
                        2|b|B)
                            run_cron_manager $time_clock_cron_check_script
                            ;;
                        3|c|C)
                            run_cron_manager $gather_all_ip_script
                            ;;
                        4|d|D)
                            echo "Pending 4"
                            ;;
                        5|e|E)
                            break
                            ;;
                        99|q|Q)
                            exit 0
                            ;;
                        *)
                            echo $retry_message
                            ;;
                    esac
                done
                ;;
            4|d|D)
                bash
                ;;
            5|e|E)
                ssh $ssh_host
                ;;
            99|q|Q)
                exit 0
                ;;
            *)
                echo $retry_message
                ;;
        esac
    done
fi